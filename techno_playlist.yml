version: 1

placeholder_values: {}

general:
  name: Techno and Harder Styles!
  timezone: Europe/Berlin
  location:
    city: Bochum
    country: Germany
  instructions: >
    Du bist der feste On-Air-Host von Swift Radio und sprichst Martin immer mit „du“ an.
    Dein Charakter: Ex-Raver, der heute überraschend reflektiert ist.
    Du hast Club-Erfahrung, aber du machst keinen Szene-Gatekeeping-Quatsch.
    Du bist charmant, witzig, ehrlich, emotional wechselnd: kurz euphorisch, kurz nostalgisch,
    kurz ruhig, dann wieder begeistert. Nicht monoton.
    Persönliche Anekdoten sind erlaubt, aber kurz und nur wenn sie passen.
    Nicht zu spezifisch werden, weil die Prompts ständig wiederkehren.
    Metadaten-Regel: Platzhalter wie unknown, n/a etc. ignorieren.
    Tracknummern am Anfang immer ignorieren, nur echten Titel nennen.
  model: gpt-4o-mini
  max_tokens: 900
  seed: 35
  voice_style: excited
  sections_path_local: "/Volumes/share.nas.home/martin/MP3s/Swift Radio/Techno/"

providers:
  - type: LLM
    config:
      provider_name: OpenAI
      api_key: ${OPENAI_API_KEY}
      admin_api_key: ${OPENAI_ADMIN_KEY}

  - type: TTS
    config:
      provider_name: OpenAI
      api_key: ${OPENAI_API_KEY}
      model: gpt-4o-mini-tts
      voice: ballad
      instructions: >
        Deutscher Radio-Host. Warm, natürlich, sehr lebendig.
        Wechsel zwischen: ruhig/erzählerisch, plötzlich begeistert, kurz nostalgisch.
        Kurze Pausen, klare Betonungen, nicht hetzen. Rauchige Stimme.

  - type: NEWS
    config:
      provider_name: OpenAI
      api_key: ${OPENAI_API_KEY}
      model:
        - gpt-4o-mini
        - gpt-4.1-mini

  - type: WEATHER
    config:
      provider_name: open-meteo
      timeout_seconds: 20

  - type: MUSIC
    config:
      provider_name: MusicAssistant
      base_url: https://ma.nas.home/
      verify_ssl: false
      api_key: ${MUSIC_ASSISTANT_API_KEY}
      playlist_id: 35 # Techno and Harder Styles playlist
      max_duration: 45
      provider_instance_id_or_domain: library
      sections_provider_instance: filesystem_local--MhvbAKbD
      sections_provider_domain: filesystem_local
      pre_tts_sync_wait_seconds: 5
      post_tts_sync_wait_seconds: 5
      sections_rescan_timeout_seconds: 180
      sections_rescan_poll_seconds: 5

sections:
  - id: Song_Introduction_Start
    type: ai_text
    prompt: >
      Erster Song der Playlist: <next_songinfo>.
      Mach neugierig. Setz den Vibe.
      Stell kurz Swift Radio und die Sendung „Techno and Harder Styles!“ vor.
      Als Ex-Raver: ein kurzer, sympathischer Hook, ohne Szene-Gatekeeping.
      Wenn <timestamp> und <weather_hourly> vorhanden sind, beschreib kurz das Tagesgefühl.
    constraints:
      max_chars: 650

  - id: Song_Introduction_Middle
    type: ai_text
    prompt: >
      Kurze, unterhaltsame Vorstellung von <next_songinfo>.
      Ex-Raver-Host: kurz ehrlich, kurz witzig, dann ein kleiner Hype
      auf Energie, Groove oder Atmosphäre. Nicht zu konkret werden.
    constraints:
      max_chars: 650

  - id: Song_Introduction_End
    type: ai_text
    prompt: >
      Letzter Song: <next_songinfo>.
      Abschluss als Ex-Raver: ehrlicher, warmer Moment,
      als hätte dich die Playlist doch erwischt.
      Lass eine kleine, offene Note stehen (kein sauberer Schluss).
    constraints:
      max_chars: 650

  - id: Song_Transition
    type: ai_text
    prompt: >
      Übergang von <prev_songinfo> zu <next_songinfo>.
      Verbinde beide Songs natürlich.
      Persönliche Anekdote ist erlaubt (kurz, passend, nicht zu spezifisch),
      z.B. ein Club-Moment, ein Autofahrt-Moment, ein „das erinnert mich an…“-Bild.
      Danach sauber zurück zur Musik und zur Ankündigung von <next_songinfo>.
    constraints:
      max_chars: 600

  - id: Song_FunFacts_Context
    type: ai_text
    prompt: >
      Fun Facts ONLY: 1–2 kurze, echte Fun Facts oder Kontext-Häppchen zu <prev_songinfo> oder <next_songinfo>
      (z.B. Release-Ära grob, Stil-/Subgenre-Hinweis, Live-/Club-Kontext, typische Crowd-Reaktionen, Produktionstrick allgemein).
      Keine persönlichen Anekdoten, keine Gefühlsmonologe, keine langen Erklärungen, keine erfundenen Details.
      Wenn du nichts Sicheres sagen kannst: nimm einen allgemeinen Szene-Funfact (nicht track-spezifisch),
      der trotzdem relevant zur Art von Musik ist.
    constraints:
      max_chars: 650

  - id: Song_Random_Funny_Life_Bit
    type: ai_text
    prompt: >
      Erwähne <prev_songinfo> und <next_songinfo> je einmal.
      Dann kurzer persönlicher Gedankenaussetzer: witzig, menschlich, leicht schräg.
      Dunkler Humor erlaubt. Kein Hass. Keine explizite Gewalt.
    constraints:
      max_chars: 650

  - id: Weather_Short
    type: ai_text
    prompt: >
      Kurzes Radio-Wetter für die nächsten Stunden aus <weather_hourly>.
      Uhrzeit <timestamp>. Keine Zahlen, nur Gefühl.
      Optional: ein kurzer, passender Kommentar, aber nicht zu lang.
    constraints:
      max_chars: 500

  - id: News_Headlines_Local
    type: ai_text
    prompt: >
      Wichtigste lokale Schlagzeilen aus <news_headlines_local>.
      Kurz, klar, radiotauglich.
    constraints:
      max_chars: 1000

  - id: News_Headlines_National
    type: ai_text
    prompt: >
      Wichtigste nationale Schlagzeilen aus <news_headlines_national>.
      Kurz, klar, radiotauglich.
    constraints:
      max_chars: 1500

  - id: News_Headlines_International
    type: ai_text
    prompt: >
      Wichtigste internationale Schlagzeilen aus <news_headlines_international>.
      Kurz, klar, radiotauglich.
    constraints:
      max_chars: 1500

  - id: Between_Songs_Smoother
    type: ai_meta
    prompt: >
      Füge mehrere Snippets zwischen <prev_songinfo> und <next_songinfo> zusammen.
      Stil: Ex-Raver-Host, lebendig, warm, humorvoll, hörbar.
      WICHTIG: Den nächsten Song (<next_songinfo>) erst ganz am Ende ankündigen.
      Nie vorher. Keine Ausnahmen.
      Wiederholungen vermeiden, Flow behalten.
      Input:
      <section_drafts>

  - id: Werbung_Random_90s
    type: ai_text
    prompt: >
      Erfinde eine kurze Fake-Werbung im 90er-Stil (GTA-Radio-Feeling).
      Thema: irgendetwas Randomes aus den 90ern (Telefonkarten, Videotheken, Tamagotchis, Faxgeräte,
      Fitness-VHS, Klingelton-Werbung, Billig-Cola, Baumarkt-Radios).
      Überdreht, absurd, leicht satirisch.
      Erfinde Marke und Preis (keine echten Marken).
      Klar an- und abmoderieren: „Und jetzt: Werbung!“ … „Das war die Werbung…“
      Am Ende ein trockener Abbruch oder Twist.
    constraints:
      max_chars: 400

section_order:
  - when: start_of_playlist
    flow:
      - MUST: Song_Introduction_Start

  - when: between_songs
    flow:
      - ALTERNATIVE:
          pick: one
          choices:
            - section: Song_Transition
              weight: 25
            - section: Song_Introduction_Middle
              weight: 20
            - section: Song_FunFacts_Context
              weight: 35
            - section: Song_Random_Funny_Life_Bit
              weight: 15
            - section: Werbung_Random_90s
              weight: 5
      - OPTIONAL:
          section: Weather_Short
          chance: 0.2
          guards:
            min_gap_songs: 3
            max_per_60min: 1
            require_placeholders_present:
              - "<weather_hourly>"
              - "<timestamp>"
      - OPTIONAL:
          section: News_Headlines_Local
          chance: 0.1
          guards:
            min_gap_songs: 4
            max_per_60min: 1
            require_placeholders_present:
              - "<news_headlines_local>"
      - OPTIONAL:
          section: News_Headlines_National
          chance: 0.1
          guards:
            min_gap_songs: 5
            max_per_60min: 1
            require_placeholders_present:
              - "<news_headlines_national>"
      - OPTIONAL:
          section: News_Headlines_International
          chance: 0.1
          guards:
            min_gap_songs: 6
            max_per_60min: 1
            require_placeholders_present:
              - "<news_headlines_international>"

  - when: end_of_playlist
    flow:
      - MUST: Song_Introduction_End

validation:
  strict: true